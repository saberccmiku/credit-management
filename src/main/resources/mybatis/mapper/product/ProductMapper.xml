<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.saber.credit.mapper.ProductMapper">

    <sql id="Base_Column_List">
            ID id,CREATE_USER,CREATE_DATE,LAST_CHANGE_USER,LAST_CHANGE_DATE,DEL_FLAG,
            NAME name,LOGO logo ,INTRODUCTION introduction,COOPERATION cooperation,SETTLEMENT_CYCLE settlementCycle,
            PRICE price, CREDIT_RATE creditRate,AMOUNT_MAX amountMax,AMOUNT_MIN amountMin,CREDIT_CYCLE creditCycle,
            AUDIT_DURATION auditDuration,PAY_SPEED paySpeed,LINKS links,ACCOUNT account,REPAYMENT repayment,REGISTER_COUNT registerCount,
            INNER_TIME_MIN innerTimeMin,INNER_TIME_MAX innerTimeMax,APPLICATION application,CREDIT_MATERIAL creditMaterial,CREDIT_INFO creditInfo,
            REVIEW review,PRE_PAYMENT prePayment,VERIFY verify,BUSINESS_NAME businessName,CONTACT contact,CONTACT_PHONE contactPhone,
            CONTACT_WECHAT contactWeChat,AUDIT_DURATION_UNIT auditDurationUnit,PAY_SPEED_UNIT paySpeedUnit,
            CREDIT_RATE_UNIT creditRateUnit
    </sql>

    <select id="queryById" resultType="com.saber.credit.entities.Product">
        SELECT u.ID id,u.NAME name,u.PHONE PHONE,a.FROM_ID fromName,a.CREATE_DATE registerDate,a.FIRST_LOGIN_DATE firstLoginDate,CASE
        WHEN TIMESTAMPDIFF(HOUR,a.CREATE_DATE,a.FIRST_LOGIN_DATE) &lt; 1 THEN '1小时内' ELSE
        CONCAT(TIMESTAMPDIFF(HOUR,a.CREATE_DATE,a.FIRST_LOGIN_DATE),'小时')
        END intervalTime,a.LOGIN_COUNT loginCount,r.DEVICE_ID deviceId,
        r.DEVICE_TYPE deviceType,u.NATIVE_PLACE nativePlace,r.NETWORK network
        from SEC_USER u
        LEFT JOIN
        USER_ACTIVE a  ON u.id = a.user_id
        LEFT JOIN
        DEVICE_REGISTER r ON r.USER_ID = u.ID
        where u.id = #{id}
    </select>

    <select id="query" resultType="com.saber.credit.entities.Product">
        select <include refid="Base_Column_List"/>  from PRODUCT
    </select>

    <select id="queryDetail" resultType="com.saber.credit.entities.Product">
        SELECT u.ID id,u.NAME name,u.PHONE PHONE,a.FROM_ID fromName,a.CREATE_DATE registerDate,a.FIRST_LOGIN_DATE firstLoginDate,CASE
        WHEN TIMESTAMPDIFF(HOUR,a.CREATE_DATE,a.FIRST_LOGIN_DATE) &lt; 1 THEN '1小时内' ELSE
        CONCAT(TIMESTAMPDIFF(HOUR,a.CREATE_DATE,a.FIRST_LOGIN_DATE),'小时')
        END intervalTime,a.LOGIN_COUNT loginCount,r.DEVICE_ID deviceId,r.DEVICE_TYPE deviceType
        from SEC_USER u
        LEFT JOIN
        USER_ACTIVE a  ON u.id = a.user_id
        LEFT JOIN
        DEVICE_REGISTER r ON r.USER_ID = u.ID
    </select>

    <insert id="insert">
        INSERT INTO PRODUCT (ID,CREATE_USER,CREATE_DATE,LAST_CHANGE_USER,LAST_CHANGE_DATE,DEL_FLAG,NAME,LOGO,
        INTRODUCTION,COOPERATION,SETTLEMENT_CYCLE,PRICE,CREDIT_RATE,AMOUNT_MAX,AMOUNT_MIN,CREDIT_CYCLE,AUDIT_DURATION,
        PAY_SPEED,LINKS,ACCOUNT,REPAYMENT,REGISTER_COUNT,INNER_TIME_MIN,INNER_TIME_MAX,APPLICATION,CREDIT_MATERIAL,CREDIT_INFO,REVIEW,
        PRE_PAYMENT,VERIFY,BUSINESS_NAME,CONTACT,CONTACT_PHONE,CONTACT_WECHAT,AUDIT_DURATION_UNIT,PAY_SPEED_UNIT,CREDIT_RATE_UNIT) VALUES (#{id},#{createUser},#{createDate},#{lastChangeUser},
        #{lastChangeDate},#{delFlag},#{name},#{logo},#{introduction},#{cooperation},#{settlementCycle},#{price},#{creditRate},#{amountMax},#{amountMin},
        #{creditCycle},#{auditDuration},#{paySpeed},#{links},#{account},#{repayment},#{registerCount},#{innerTimeMin},#{innerTimeMax},#{application},
        #{creditMaterial},#{creditInfo},#{review},#{prePayment},#{verify},#{businessName},#{contact},#{contactPhone},#{contactWeChat},#{auditDurationUnit},
        #{paySpeedUnit},#{creditRateUnit})
    </insert>

</mapper>