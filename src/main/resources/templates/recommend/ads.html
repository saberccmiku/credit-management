<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <<title>贷超管理系统</title>
  <!-- plugins:css -->
  <link rel="stylesheet" th:href="@{/vendors/iconfonts/mdi/css/materialdesignicons.min.css}">
  <link rel="stylesheet" th:href="@{/vendors/css/vendor.bundle.base.css}">
  <!-- endinject -->
  <!-- plugin css for this page -->
  <link rel="stylesheet" th:href="@{/webjars/bootstrap-fileinput/css/fileinput.css}">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" th:href="@{/asserts/css/style.css}">
  <link rel="shortcut icon" th:href="@{/favicon.ico}"/>
</head>

<body>
<div class="container-scroller">
  <!-- partial:../../partials/_navbar.html -->
  <div th:replace="/commons/bar::topBar"></div>
  <!-- partial -->
  <div class="container-fluid page-body-wrapper">
    <!-- partial:../../partials/_sidebar.html -->
    <div th:replace="/commons/bar::#sideBar"></div>
    <!-- partial -->
    <div class="main-panel">
      <div class="content-wrapper">
        <div class="col-lg-12 grid-margin stretch-card">
          <div class="card">
            <div class="card-body">
              <!-- Button trigger modal -->
              <button type="button" class="btn btn-success btn-sm mb-3" data-toggle="modal"
                      data-target="#exampleModalCenter">
                添加广告图
              </button>
              <!-- Modal -->
              <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
                   aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <form class="forms-sample needs-validation" th:action="@{/user/sendMessage}"
                      method="post" novalidate>
                  <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content bg-white">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalCenterTitle">添加广告图</h5>
                        <button type="button" class="close" data-dismiss="modal"
                                aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        <div class="card-body">
                          <div class="form-group row">
                            <!--头像-->
                            <div class="form-group row">
                              <div class="col-sm-4">
                                <input id="avatar" name="avatar" type="file" multiple  class="file-loading"  data-show-upload="false" data-show-caption="true">
                              </div>
                            </div>
                          </div>
                          <div class="form-group row">
                            <label for="title"
                                   class="col-sm-4 col-form-label ant-form-item-required">通知标题：</label>
                            <div class="col-sm-8 row">
                              <input type="text" class="form-control rounded"
                                     id="title" name="title"
                                     placeholder="请输入通知标题,15个字以内" required>
                              <div class="invalid-feedback">请输入通知标题,15个字以内</div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-default rounded"
                                data-dismiss="modal">取消
                        </button>
                        <button type="submit" class="btn btn-info">保存</button>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <p class="card-description">
                图片推荐：
                <code class="btn-group" role="group" aria-label="Basic example">
                <button th:id="${enumerateItem.code}" type="button" class="btn btn-outline-info btn-sm" th:each="enumerateItem:${enumerate.IMG_RECOMMEND.itemList}">
                  [[${enumerateItem.value}]]
                </button>
               </code>
              </p>
              <table class="table table-bordered">
                <thead>
                <tr>
                  <th>
                    位置
                  </th>
                  <th>
                    链接类型
                  </th>
                  <th>
                    链接目标页名称
                  </th>
                  <th>
                    图片预览
                  </th>
                  <th>
                    添加时间
                  </th>
                  <th>
                    状态
                  </th>
                  <th>
                    操作
                  </th>
                </tr>
                </thead>
                <tbody>
                <tr>
                  <td>
                    1
                  </td>
                  <td>
                    Herman Beck
                  </td>
                  <td>
                    <div class="progress">
                      <div class="progress-bar bg-success" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </td>
                  <td>
                    $ 77.99
                  </td>
                  <td>
                    May 15, 2015
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <!-- content-wrapper ends -->
      <!-- partial:../../partials/_footer.html -->
      <div th:replace="/commons/bar::#footerBar"></div>
      <!-- partial -->
    </div>
    <!-- main-panel ends -->
  </div>
  <!-- page-body-wrapper ends -->
</div>
<!-- container-scroller -->
<!-- plugins:js -->
<script th:src="@{/vendors/js/vendor.bundle.base.js}"></script>
<script th:src="@{/vendors/js/vendor.bundle.addons.js}"></script>
<!-- endinject -->
<!-- Plugin js for this page-->
<script th:src="@{/webjars/bootstrap-fileinput/js/fileinput.js}"></script>
<script th:src="@{/webjars/bootstrap-fileinput/js/locales/zh.js}"></script>
<!-- End plugin js for this page-->
<!-- inject:js -->
<script th:src="@{/asserts/js/off-canvas.js}"></script>
<script th:src="@{/asserts/js/misc.js}"></script>
<!-- endinject -->
<!-- Custom js for this page-->
<!-- End custom js for this page-->
<script th:inline="javascript">
  $(function () {
      $('#IMG_RECOMMEND_LBT').addClass("active")
  })

  //初始化fileinput插件
  $(function () {
      //0.初始化fileinput
      var oFileInput = new FileInput();
      oFileInput.Init("avatar", "/api/OrderApi/ImportOrder");
  });

  //初始化fileinput
  var FileInput = function () {
      var oFile = new Object();

      //初始化fileinput控件（第一次初始化）
      oFile.Init = function(ctrlName, uploadUrl) {
          var control = $('#' + ctrlName);

          //初始化上传控件的样式
          control.fileinput({
              language: 'zh', //设置语言
              uploadUrl: '/api/OrderApi/ImportOrder', //上传的地址,影响略缩图上的删除和上传按钮
              allowedFileExtensions: ['jpg', 'gif', 'png'],//接收的文件后缀
              showUpload: false, //是否显示上传按钮
              showCaption: false,//是否显示标题
              browseClass: "btn btn-primary", //按钮样式
              dropZoneEnabled: true,//是否显示拖拽区域
              showCancel:false,
              //minImageWidth: 50, //图片的最小宽度
              //minImageHeight: 50,//图片的最小高度
              //maxImageWidth: 1000,//图片的最大宽度
              //maxImageHeight: 1000,//图片的最大高度
              maxFileSize: 200,//单位为kb，如果为0表示不限制文件大小
              minFileCount: 1,
              maxFileCount: 1, //表示允许同时上传的最大文件个数
              enctype: 'multipart/form-data',
              validateInitialCount:true,
              previewFileIcon: "<i class='glyphicon glyphicon-king'></i>",
              msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
              layoutTemplates :{
//                    actionDelete:'', //去除上传预览的缩略图中的删除图标
//                    actionUpload:'',//去除上传预览缩略图中的上传图片；
//                    actionZoom:'<i class="mdi mdi-user-box-outline"></i>'   //去除上传预览缩略图中的查看详情预览的缩略图标。
              }
          });
          //导入文件上传完成之后的事件
          $("#avatar").on("fileuploaded", function (event, data, previewId, index) {
              $("#myModal").modal("hide");
              var data = data.response.lstOrderImport;
              if (data == undefined) {
                  toastr.error('文件格式类型不正确');
                  return;
              }
              //1.初始化表格
              var oTable = new TableInit();
              oTable.Init(data);
              $("#div_startimport").show();
          });
      };
      return oFile;
  };
</script>
</body>
</html>
